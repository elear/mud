<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Manufacturer Usage Description Specification</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 What MUD doesn&#8217;t do">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 A Simple Example">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Determining Intended Use">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Finding A Policy: The MUD URL">
<link href="#rfc.section.1.5" rel="Chapter" title="1.5 Types of Policies">
<link href="#rfc.section.1.6" rel="Chapter" title="1.6 Terminology">
<link href="#rfc.section.1.7" rel="Chapter" title="1.7 The Manufacturer Usage Description Architecture">
<link href="#rfc.section.1.8" rel="Chapter" title="1.8 Order of operations">
<link href="#rfc.section.2" rel="Chapter" title="2 The MUD Model and Semantic Meaning">
<link href="#rfc.section.3" rel="Chapter" title="3 Element Definitions">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 last-update">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 cache-validity">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 masa-server">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 is-supported">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 systeminfo">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 extensions">
<link href="#rfc.section.3.7" rel="Chapter" title="3.7 packet-direction">
<link href="#rfc.section.3.8" rel="Chapter" title="3.8 manufacturer">
<link href="#rfc.section.3.9" rel="Chapter" title="3.9 same-manufacturer">
<link href="#rfc.section.3.10" rel="Chapter" title="3.10 model">
<link href="#rfc.section.3.11" rel="Chapter" title="3.11 local-networks">
<link href="#rfc.section.3.12" rel="Chapter" title="3.12 controller">
<link href="#rfc.section.3.13" rel="Chapter" title="3.13 my-controller">
<link href="#rfc.section.3.14" rel="Chapter" title="3.14 direction-initiated">
<link href="#rfc.section.4" rel="Chapter" title="4 Processing of the MUD file">
<link href="#rfc.section.5" rel="Chapter" title="5 What does a MUD URL look like?">
<link href="#rfc.section.6" rel="Chapter" title="6 The MUD YANG Model">
<link href="#rfc.section.7" rel="Chapter" title="7 The Domain Name Extension to the ACL Model">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 source-dnsname">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 destination-dnsname">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 The ietf-acldns Model">
<link href="#rfc.section.8" rel="Chapter" title="8 MUD File Example">
<link href="#rfc.section.9" rel="Chapter" title="9 The MUD URL DHCP Option">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Client Behavior">
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 Server Behavior">
<link href="#rfc.section.9.3" rel="Chapter" title="9.3 Relay Requirements">
<link href="#rfc.section.10" rel="Chapter" title="10 The Manufacturer Usage Description (MUD) URL X.509 Extension">
<link href="#rfc.section.11" rel="Chapter" title="11 The Manufacturer Usage Description LLDP extension">
<link href="#rfc.section.12" rel="Chapter" title="12 Creating and Processing of Signed MUD Files">
<link href="#rfc.section.12.1" rel="Chapter" title="12.1 Creating a MUD file signature">
<link href="#rfc.section.12.2" rel="Chapter" title="12.2 Verifying a MUD file signature">
<link href="#rfc.section.13" rel="Chapter" title="13 Extensibility">
<link href="#rfc.section.14" rel="Chapter" title="14 Deployment Considerations">
<link href="#rfc.section.15" rel="Chapter" title="15 Security Considerations">
<link href="#rfc.section.16" rel="Chapter" title="16 IANA Considerations">
<link href="#rfc.section.16.1" rel="Chapter" title="16.1 YANG Module Registrations">
<link href="#rfc.section.16.2" rel="Chapter" title="16.2 DHCPv4 and DHCPv6 Options">
<link href="#rfc.section.16.3" rel="Chapter" title="16.3 PKIX Extensions">
<link href="#rfc.section.16.4" rel="Chapter" title="16.4 Well Known URI Suffix">
<link href="#rfc.section.16.5" rel="Chapter" title="16.5 MIME Media-type Registration for MUD files">
<link href="#rfc.section.16.6" rel="Chapter" title="16.6 LLDP IANA TLV Subtype Registry">
<link href="#rfc.section.16.7" rel="Chapter" title="16.7 The MUD Well Known Universal Resource Name (URNs)">
<link href="#rfc.section.17" rel="Chapter" title="17 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="18 References">
<link href="#rfc.references.1" rel="Chapter" title="18.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="18.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Changes from Earlier Versions">
<link href="#rfc.appendix.B" rel="Chapter" title="B Default MUD elements">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.6.2 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Lear, E., Droms, R., and D. Romascanu" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-opsawg-mud-07" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-7-03" />
  <meta name="dct.abstract" content="This memo specifies a component-based architecture for manufacturer usage descriptions (MUD). This includes two YANG modules, IPv4 and IPv6 DHCP options, an LLDP TLV, a URL suffix specification, an X.509 certificate extension and a means to sign and verify the descriptions." />
  <meta name="description" content="This memo specifies a component-based architecture for manufacturer usage descriptions (MUD). This includes two YANG modules, IPv4 and IPv6 DHCP options, an LLDP TLV, a URL suffix specification, an X.509 certificate extension and a means to sign and verify the descriptions." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">E. Lear</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Cisco Systems</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">R. Droms</td>
</tr>
<tr>
<td class="left">Expires: January 4, 2018</td>
<td class="right"></td>
</tr>
<tr>
<td class="left"></td>
<td class="right">D. Romascanu</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">July 03, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Manufacturer Usage Description Specification<br />
  <span class="filename">draft-ietf-opsawg-mud-07</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This memo specifies a component-based architecture for manufacturer usage descriptions (MUD). This includes two YANG modules, IPv4 and IPv6 DHCP options, an LLDP TLV, a URL suffix specification, an X.509 certificate extension and a means to sign and verify the descriptions.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 4, 2018.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">What MUD doesn&#8217;t do</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">A Simple Example</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Determining Intended Use</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Finding A Policy: The MUD URL</a>
</li>
<li>1.5.   <a href="#rfc.section.1.5">Types of Policies</a>
</li>
<li>1.6.   <a href="#rfc.section.1.6">Terminology</a>
</li>
<li>1.7.   <a href="#rfc.section.1.7">The Manufacturer Usage Description Architecture</a>
</li>
<li>1.8.   <a href="#rfc.section.1.8">Order of operations</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">The MUD Model and Semantic Meaning</a>
</li>
<li>3.   <a href="#rfc.section.3">Element Definitions</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">last-update</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">cache-validity</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">masa-server</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">is-supported</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">systeminfo</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">extensions</a>
</li>
<li>3.7.   <a href="#rfc.section.3.7">packet-direction</a>
</li>
<li>3.8.   <a href="#rfc.section.3.8">manufacturer</a>
</li>
<li>3.9.   <a href="#rfc.section.3.9">same-manufacturer</a>
</li>
<li>3.10.   <a href="#rfc.section.3.10">model</a>
</li>
<li>3.11.   <a href="#rfc.section.3.11">local-networks</a>
</li>
<li>3.12.   <a href="#rfc.section.3.12">controller</a>
</li>
<li>3.13.   <a href="#rfc.section.3.13">my-controller</a>
</li>
<li>3.14.   <a href="#rfc.section.3.14">direction-initiated</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">Processing of the MUD file</a>
</li>
<li>5.   <a href="#rfc.section.5">What does a MUD URL look like?</a>
</li>
<li>6.   <a href="#rfc.section.6">The MUD YANG Model</a>
</li>
<li>7.   <a href="#rfc.section.7">The Domain Name Extension to the ACL Model</a>
</li>
<ul><li>7.1.   <a href="#rfc.section.7.1">source-dnsname</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">destination-dnsname</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">The ietf-acldns Model</a>
</li>
</ul><li>8.   <a href="#rfc.section.8">MUD File Example</a>
</li>
<li>9.   <a href="#rfc.section.9">The MUD URL DHCP Option</a>
</li>
<ul><li>9.1.   <a href="#rfc.section.9.1">Client Behavior</a>
</li>
<li>9.2.   <a href="#rfc.section.9.2">Server Behavior</a>
</li>
<li>9.3.   <a href="#rfc.section.9.3">Relay Requirements</a>
</li>
</ul><li>10.   <a href="#rfc.section.10">The Manufacturer Usage Description (MUD) URL X.509 Extension</a>
</li>
<li>11.   <a href="#rfc.section.11">The Manufacturer Usage Description LLDP extension</a>
</li>
<li>12.   <a href="#rfc.section.12">Creating and Processing of Signed MUD Files</a>
</li>
<ul><li>12.1.   <a href="#rfc.section.12.1">Creating a MUD file signature</a>
</li>
<li>12.2.   <a href="#rfc.section.12.2">Verifying a MUD file signature</a>
</li>
</ul><li>13.   <a href="#rfc.section.13">Extensibility</a>
</li>
<li>14.   <a href="#rfc.section.14">Deployment Considerations</a>
</li>
<li>15.   <a href="#rfc.section.15">Security Considerations</a>
</li>
<li>16.   <a href="#rfc.section.16">IANA Considerations</a>
</li>
<ul><li>16.1.   <a href="#rfc.section.16.1">YANG Module Registrations</a>
</li>
<li>16.2.   <a href="#rfc.section.16.2">DHCPv4 and DHCPv6 Options</a>
</li>
<li>16.3.   <a href="#rfc.section.16.3">PKIX Extensions</a>
</li>
<li>16.4.   <a href="#rfc.section.16.4">Well Known URI Suffix</a>
</li>
<li>16.5.   <a href="#rfc.section.16.5">MIME Media-type Registration for MUD files</a>
</li>
<li>16.6.   <a href="#rfc.section.16.6">LLDP IANA TLV Subtype Registry</a>
</li>
<li>16.7.   <a href="#rfc.section.16.7">The MUD Well Known Universal Resource Name (URNs)</a>
</li>
</ul><li>17.   <a href="#rfc.section.17">Acknowledgments</a>
</li>
<li>18.   <a href="#rfc.references">References</a>
</li>
<ul><li>18.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>18.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Changes from Earlier Versions</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.B">Default MUD elements</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The Internet has largely been constructed on general purpose computers; those devices that may be used for a purpose that is specified by those who buy the device.  <a href="#RFC1984" class="xref">[RFC1984]</a> presumed that an end device would be most capable of protecting itself.  This made sense when the typical device was a workstation or a mainframe, and it continues to make sense for general purpose computing devices today, including laptops, smart phones, and tablets.</p>
<p><a href="#RFC7452" class="xref">[RFC7452]</a> discusses design patterns for, and poses questions about, smart objects.  Let us then posit a group of objects that are specifically NOT general purpose computers.  These devices therefore have a purpose to their use.  By definition, therefore, all other purposes are NOT intended.  The combination of these two statements can be restated as a manufacturer usage description (MUD) that can be applied at various points within a network.  Although this memo may seem to stress access requirements, usage intent also consists of quality of service needs a device may have.</p>
<p id="rfc.section.1.p.3">We use the notion of &#8220;manufacturer&#8221; loosely in this context, to simply mean the entity or organization that will state how a device is intended to be used.  In the context of a lightbulb, this might indeed be the lightbulb manufacturer.  In the context of a smarter device that has a built in Linux stack, it might be integrator of that device.  The key points are that the device itself is expected to serve a limited purpose, and that there may exist an organization in the supply chain of that device that will take responsibility for informing the network about that purpose.</p>
<p id="rfc.section.1.p.4">The intent of MUD is to therefore solve for the following problems:</p>
<p></p>

<ul>
<li>Substantially reduce the threat surface on a device entering a network to those communications intended by the manufacturer.</li>
<li>Provide for a means to scale network policies to the ever-increasing number types of devices in the network.</li>
<li>Provide a means to address at least some vulnerabilities in a way that is faster than it might take to update systems.  This will be particularly true for systems that are no longer supported by their manufacturer.</li>
<li>Keep the cost of implementation of such a system to the bare minimum.</li>
</ul>
<p id="rfc.section.1.p.6">MUD therefore consists of three architectural building blocks: - A classifier that a device emits that can be used to locate a description; - The description itself, including how it is interpreted, and; - A means to retrieve the description.</p>
<p id="rfc.section.1.p.7">In this specification we specify each of these building blocks and how they are intended to be used together.  However, they may also be used separately, independent of this specification by enterprise networks for their own purposes.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#what-mud-doesnt-do" id="what-mud-doesnt-do">What MUD doesn&#8217;t do</a>
</h1>
<p id="rfc.section.1.1.p.1">General computing systems will benefit very little from MUD, as their manufacturers cannot envision a specific communication pattern to describe.  In addition, even those devices that have a single or small number of uses might have very broad communication patterns.  MUD is not for them either.</p>
<p id="rfc.section.1.1.p.2">No matter how good a MUD-enabled network is, it will never replace the need for manufacturers to patch vulnerabilities.  It may, however, provide network administrators with some additional protection when those vulnerabilities exist.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#a-simple-example" id="a-simple-example">A Simple Example</a>
</h1>
<p id="rfc.section.1.2.p.1">A light bulb is intended to light a room.  It may be remotely controlled through the network; and it may make use of a rendezvous service of some form that an app on smart phone accesses.  What we can say about that light bulb, then, is that all other network access is unwanted.  It will not contact a news service, nor speak to the refrigerator, and it has no need of a printer or other devices.  It has no Facebook friends.  Therefore, an access list applied to it that states that it will only connect to the single rendezvous service will not impede the light bulb in performing its function, while at the same time allowing the network to provide both it and other devices an additional layer of protection.</p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#determining-intended-use" id="determining-intended-use">Determining Intended Use</a>
</h1>
<p id="rfc.section.1.3.p.1">The notion of intended use is in itself not new.  Network administrators apply access lists every day to allow for only such use.  This notion of white listing was well described by Chapman and Zwicky in <a href="#FW95" class="xref">[FW95]</a>.  Programmatically profiling systems have existed for years as well.  These systems make use of heuristics that take at least some time to assert what a system is.</p>
<p id="rfc.section.1.3.p.2">A system could just as easily tell the network what sort of protection it requires without going into what sort of system it is.  This would, in effect, be the converse of <a href="#RFC7488" class="xref">[RFC7488]</a>.  In seeking a general purpose solution, however, we assume that a device has so few capabilities that it will implement the least necessary capabilities to function properly.  This is a basic economic constraint.  Unless the network would refuse access to such a device, its developers would have no reason to implement such an approach.  To date, such an assertion has held true.</p>
<h1 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> <a href="#finding-a-policy-the-mud-url" id="finding-a-policy-the-mud-url">Finding A Policy: The MUD URL</a>
</h1>
<p id="rfc.section.1.4.p.1">Our work begins, therefore, with the device emitting a Universal Resource Locator (URL) <a href="#RFC3986" class="xref">[RFC3986]</a>.  This URL may serves both to classify the device type and to provide a means to locate a policy file.</p>
<p id="rfc.section.1.4.p.2">In this memo three means are defined to emit the MUD URL.  One is a DHCP option<a href="#RFC2131" class="xref">[RFC2131]</a>,<a href="#RFC3315" class="xref">[RFC3315]</a> that the DHCP client uses to inform the DHCP server.  The DHCP server may take further actions, such as retrieve the URL or otherwise pass it along to network management system or controller.  The other method defined is an X.509 constraint.  The IEEE has developed <a href="#IEEE8021AR" class="xref">[IEEE8021AR]</a> that provides a certificate-based approach to communicate device characteristics, which itself relies on <a href="#RFC5280" class="xref">[RFC5280]</a>.  The MUD URL extension is non-critical, as required by IEEE 802.1AR. Various means may be used to communicate that certificate, including Tunnel Extensible Authentication Protocol (TEAP) <a href="#RFC7170" class="xref">[RFC7170]</a>.  Finally, a Link Layer Discovery Protocol (LLDP) frame is defined <a href="#IEEE8021AB" class="xref">[IEEE8021AB]</a>.</p>
<p id="rfc.section.1.4.p.3">It is possible that there may be other means for a MUD URL to be learned by a network.  For instance, if a device has a serial number, it may be possible for the MUD controller to perform a lookup of the device, if it has some knowledge as to who the device manufacturer is, and what its MUD file server is.  Such mechanisms are not described in this memo, but are possible.</p>
<h1 id="rfc.section.1.5">
<a href="#rfc.section.1.5">1.5.</a> <a href="#types-of-policies" id="types-of-policies">Types of Policies</a>
</h1>
<p id="rfc.section.1.5.p.1">When the MUD URL is resolved, the MUD controller retrieves a file that describes what sort of communications a device is designed to have.  The manufacturer may specify either specific hosts for cloud based services or certain classes for access within an operational network.  An example of a class might be &#8220;devices of a specified manufacturer type&#8221;, where the manufacturer type itself is indicated simply by the authority component (e.g, the domain name) of the MUD URL.  Another example might to allow or disallow local access.  Just like other policies, these may be combined.  For example:</p>
<pre>
   Allow access to devices of the same manufacturer
   Allow access to and from controllers who need to speak COAP
   Allow access to local DNS/DHCP
   Deny all other access
</pre>
<p id="rfc.section.1.5.p.2">To add a bit more depth that should not be a stretch of anyone&#8217;s imagination, one could also make use of port-based access lists.  Thus a printer might have a description that states:</p>
<pre>
   Allow access for port IPP or port LPD
   Allow local access for port HTTP
   Deny all other access
</pre>
<p id="rfc.section.1.5.p.3">In this way anyone can print to the printer, but local access would be required for the management interface.</p>
<p id="rfc.section.1.5.p.4">The files that are retrieved are intended to be closely aligned to existing network architectures so that they are easy to deploy.  We make use of YANG <a href="#RFC6020" class="xref">[RFC6020]</a> because of the time and effort spent to develop accurate and adequate models for use by network devices.  JSON is used as a serialization for compactness and readability, relative to XML.</p>
<p id="rfc.section.1.5.p.5">While the policy examples given here focus on access control, this is not intended to be the sole focus, and by structuring the model described in this document with clear extension points, and by leveraging YANG-based models, we provide the opportunity for new policies to be introduced as required.</p>
<p id="rfc.section.1.5.p.6">The YANG modules specified here are extensions of <a href="#I-D.ietf-netmod-acl-model" class="xref">[I-D.ietf-netmod-acl-model]</a>.  The extensions to this model allow for a manufacturer to express classes of systems that a manufacturer would find necessary for the proper function of the device.  Two modules are specified. The first module specifies a means for domain names to be used in ACLs so that devices that have their controllers in the cloud may be appropriately authorized with domain names, where the mapping of those names to addresses may rapidly change.</p>
<p id="rfc.section.1.5.p.7">The other module abstracts away IP addresses into certain classes that are instantiated into actual IP addresses through local processing.  Through these classes, manufacturers can specify how the device is designed to communicate, so that network elements can be configured by local systems that have local topological knowledge.  That is, the deployment populates the classes that the manufacturer specifies.  The abstractions are as follows:</p>
<p></p>

<dl>
<dt>Manufacturer:</dt>
<dd style="margin-left: 8">A device made by a particular manufacturer, as identified by the authority component of its MUD-URL</dd>
<dt>same-manufacturer:</dt>
<dd style="margin-left: 8">Devices that have the same authority component of their MUD-URL.</dd>
<dt>Controller:</dt>
<dd style="margin-left: 8">A device that the local network administrator admits to the particular class.</dd>
<dt>my-controller:</dt>
<dd style="margin-left: 8">A class associated with the MUD-URL of a device that the administrator admits.</dd>
</dl>
<p id="rfc.section.1.5.p.9">The &#8220;manufacturer&#8221; classes can be easily specified by the manufacturer, whereas controller classes are initially envisioned to be specified by the administrator.</p>
<p id="rfc.section.1.5.p.10">Because manufacturers do not know who will be using their devices, it is important for functionality referenced in usage descriptions to be relatively ubiquitous, and therefore, mature.  Therefore, only a a limited subset YANG-based configuration of is permitted in a MUD file.</p>
<h1 id="rfc.section.1.6">
<a href="#rfc.section.1.6">1.6.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p></p>

<dl>
<dt>MUD:</dt>
<dd style="margin-left: 8">manufacturer usage description.</dd>
<dt>MUD file:</dt>
<dd style="margin-left: 8">a file containing YANG-based JSON that describes a recommended behavior.</dd>
<dt>MUD file server:</dt>
<dd style="margin-left: 8">a web server that hosts a MUD file.</dd>
<dt>MUD controller:</dt>
<dd style="margin-left: 8">the system that requests and receives the MUD file from the MUD server.  After it has processed a MUD file it may direct changes to relevant network elements.</dd>
<dt>MUD URL:</dt>
<dd style="margin-left: 8">a URL that can be used by the MUD controller to receive the MUD file.</dd>
<dt>Thing:</dt>
<dd style="margin-left: 8">the end device that emits a MUD URL.</dd>
<dt>Manufacturer:</dt>
<dd style="margin-left: 8">the entity that configures the Thing to emit the MUD URL and the one who asserts a recommendation in a MUD file.  The manufacturer might not always be the entity that constructs a device.  It could, for instance, be a systems integrator, or even a component provider.</dd>
</dl>
<p id="rfc.section.1.6.p.2">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;,  &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in <a href="#RFC2119" class="xref">[RFC2119]</a>.</p>
<h1 id="rfc.section.1.7">
<a href="#rfc.section.1.7">1.7.</a> <a href="#the-manufacturer-usage-description-architecture" id="the-manufacturer-usage-description-architecture">The Manufacturer Usage Description Architecture</a>
</h1>
<p id="rfc.section.1.7.p.1">With these components laid out we now have the basis for an archicture.  This leads us to ASCII art.</p>
<div id="rfc.figure.1"></div>
<div id="fig1"></div>
<pre>
 .........................................
 .                      ____________     .           _____________ 
 .                     |            |    .          |             |
 .                     |    MUD     |-----&gt;get URL-&gt;|   MUD       |
 .                     | Controller |    .(https)   | File Server |
 .  End system network |____________|&lt;--MUD file&lt;--&lt;|_____________|
 .                             .         .
 .                             .         .
 . _______                 _________     .
 .|       |  (dhcp et al) | router  |    .
 .| Thing |----&gt;MUD URL--&gt;|   or    |    .
 .|_______|               | switch  |    .
 .                        |_________|    .
 .........................................
</pre>
<p class="figure">Figure 1: MUD Architecture</p>
<p id="rfc.section.1.7.p.2">In the above diagram, the switch or router collects MUD URLs and forwards them to the network management system for processing.  This happens in different ways, depending on how the URI is communicated.  For instance, in the case of DHCP, the DHCP server might receive the URI and then process it.  In the case of IEEE 802.1X, the switch would carry the URI via a certificate to the authentication server via EAP over Radius<a href="#RFC3748" class="xref">[RFC3748]</a>, which would then process it.  One method to do this is TEAP, described in <a href="#RFC7170" class="xref">[RFC7170]</a>.  The certificate extension is described below.</p>
<p id="rfc.section.1.7.p.3">The information returned by the web site is valid for the duration of the device&#8217;s connection, or as specified in the description.  Thus if the device is mobile, when it moves on, any configuration in the switch is removed.  Similarly, from time to time the description may be refreshed, based on new capabilities or communication patterns or vulnerabilities.</p>
<p id="rfc.section.1.7.p.4">The web site is typically run by or on behalf of the manufacturer.  Its domain name is that of the authority found in the MUD URL.  For legacy cases where Things cannot emit a URL, if the switch is able to determine the appropriate URI, it may proxy it, the trivial cases being a map between some registered device or port and a URL.</p>
<h1 id="rfc.section.1.8">
<a href="#rfc.section.1.8">1.8.</a> <a href="#order-of-operations" id="order-of-operations">Order of operations</a>
</h1>
<p id="rfc.section.1.8.p.1">As mentioned above, MUD contains architectural building blocks, and so order of operation may vary.  However, here is one clear intended example:</p>
<p></p>

<ol>
<li>Device emits URL.</li>
<li>That URL is forwarded to a MUD controller by the nearest switch (how this happens depends on the way in which the MUD URL is emitted).</li>
<li>The MUD controller retrieves the MUD file from the MUD file server, assuming it doesn&#8217;t already have a copy.  It may test the URL against a reputation service, and it may test any hosts within the file against reputation services, as it deems fit.</li>
<li>The MUD controller may query the administrator for permission to add the device and associated policy.  If the device is known or the device type is known, it may skip this step.</li>
<li>The MUD controller instantiates local configuration based on the abstractions defined in this document.</li>
<li>The MUD controller configures the switch nearest the device.  Other systems may be configured as well.</li>
<li>When the device disconnects, policy is removed.</li>
</ol>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#the-mud-model-and-semantic-meaning" id="the-mud-model-and-semantic-meaning">The MUD Model and Semantic Meaning</a>
</h1>
<p id="rfc.section.2.p.1">A MUD file consists of JSON based on a YANG model.  For purposes of MUD, the elements that can be modified are access lists as augmented by this model.  The MUD file is limited to the serialization of a small number of YANG schema, including the models specified in the following documents:</p>
<p></p>

<ul>
<li><a href="#I-D.ietf-netmod-acl-model" class="xref">[I-D.ietf-netmod-acl-model]</a></li>
<li><a href="#RFC6991" class="xref">[RFC6991]</a></li>
</ul>
<p id="rfc.section.2.p.3">Publishers of MUD files MUST NOT include other elements except as described in <a href="#extensions" class="xref">Section 3.6</a>, and MUST only contain information relevant to the device being described.  Devices parsing MUD files MUST cease processing if they find other elements.</p>
<p id="rfc.section.2.p.4">&#171;&#171;&#171;&lt; HEAD This module is structured into four parts: ======= This module is structured into three parts: &#187;&#187;&#187;&gt; 65993f0e9f5c2f7fbecf691a46d9374307e1891e</p>
<p></p>

<ul>
<li>The first container, metainfo, holds information that is relevant to retrieval and validity of the MUD file itself.</li>
<li>The second container, device, describes the policies to be applied to traffic to and from the device. The only policy currently defined is a list of access control lists, but the from-device-policy and to-device-policy containers serve as extension points for subsequent augmentation.</li>
</ul>
<p id="rfc.section.2.p.6">&#171;&#171;&#171;&lt; HEAD * The third container augments the matching container of the ACL model to add several elements that are relevant to the MUD URL, or other otherwise abstracted for use within a local environment.</p>
<p></p>

<ul><li>The fourth container augments the tcp-acl container of the ACL model to add the ability to match on the direction of initiation of a TCP connection.</li></ul>
<p id="rfc.section.2.p.8">======= * The final container augments the matching container of the ACL model to add several elements that are relevant to the MUD URL, or other otherwise abstracted for use within a local environment.</p>
<p></p>

<ul class="empty"><li><ul class="empty"><li><ul class="empty"><li><ul class="empty"><li><ul class="empty"><li><ul class="empty"><li><ul class="empty"><li>65993f0e9f5c2f7fbecf691a46d9374307e1891e A simplified graphical representation of the data models is used in this document.  The meaning of the symbols in these diagrams is defined in <a href="#I-D.ietf-netmod-rfc6087bis" class="xref">[I-D.ietf-netmod-rfc6087bis]</a>.</li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul>
<pre>
module: ietf-mud
    +--rw metainfo
    |  +--rw last-update?      yang:date-and-time
    |  +--rw cache-validity?   uint8
    |  +--rw masa-server?      inet:uri
    |  +--rw is-supported?     boolean
    |  +--rw systeminfo?       inet:uri
    |  +--rw extensions*       string
    +--rw device
       +--rw from-device-policy
       |  +--rw access-lists
       |     +--rw access-list* [acl-name acl-type]
       |        +--rw acl-name    -&gt; /acl:access-lists/acl/acl-name
       |        +--rw acl-type    identityref
       +--rw to-device-policy
          +--rw access-lists
             +--rw access-list* [acl-name acl-type]
                +--rw acl-name    -&gt; /acl:access-lists/acl/acl-name
                +--rw acl-type    identityref
  augment /acl:access-lists/acl:acl/acl:access-list-entries \
          /acl:ace/acl:matches:
    +--rw mud-acl {mud-acl}?
       +--rw manufacturer?        inet:host
       +--rw same-manufacturer?   empty
       +--rw model?               string
       +--rw local-networks?      empty
       +--rw controller?          inet:uri
       +--rw my-controller?       empty
  augment /acl:access-lists/acl:acl/acl:access-list-entries \
          /acl:ace/acl:matches/acl:tcp-acl:
    +--rw direction-initiated?   direction
</pre>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#element-definitions" id="element-definitions">Element Definitions</a>
</h1>
<p id="rfc.section.3.p.1">The following elements are defined.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#last-update" id="last-update">last-update</a>
</h1>
<p id="rfc.section.3.1.p.1">This is a date-and-time value of when the MUD file was generated.  This is akin to a version number.  Its form is taken from <a href="#RFC6991" class="xref">[RFC6991]</a> which, for those keeping score, turn was taken from Section 5.6 of <a href="#RFC3339" class="xref">[RFC3339]</a>, which was taken from <a href="#ISO.8601.1988" class="xref">[ISO.8601.1988]</a>.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#cache-validity" id="cache-validity">cache-validity</a>
</h1>
<p id="rfc.section.3.2.p.1">This uint8 is the period of time in hours that a network management station MUST wait since its last retrieval before checking for an update.  It is RECOMMENDED that this value be no less than 24 and MUST NOT be more than 168 for any device that is supported.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#masa-server" id="masa-server">masa-server</a>
</h1>
<p id="rfc.section.3.3.p.1">This optional element refers to the URL that should be used to resolve the location any MASA service, as specified in <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a>.</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#is-supported" id="is-supported">is-supported</a>
</h1>
<p id="rfc.section.3.4.p.1">This boolean is an indication from the manufacturer to the network administrator as to whether or not the device is supported.  In this context a device is said to be supported if the manufacturer might issue an update to the device or if the manufacturer might update the MUD file.</p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#systeminfo" id="systeminfo">systeminfo</a>
</h1>
<p id="rfc.section.3.5.p.1">This is a URL that points to a description of the device to be connected.  The intent is for administrators to be able to read about what the device is the first time the MUD-URL is used.</p>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> <a href="#extensions" id="extensions">extensions</a>
</h1>
<p id="rfc.section.3.6.p.1">This optional leaf-list names MUD extensions that are used in the MUD file.  Note that NO MUD extensions may be used in a MUD file prior to the extensions being declared.  Implementations MUST ignore any elements in this file that they do not understand.</p>
<h1 id="rfc.section.3.7">
<a href="#rfc.section.3.7">3.7.</a> <a href="#packet-direction" id="packet-direction">packet-direction</a>
</h1>
<p><a href="#I-D.ietf-netmod-acl-model" class="xref">[I-D.ietf-netmod-acl-model]</a> describes access-lists but does not attempt to indicate where they are applied as that is handled elsewhere in a configuration.  However, in this case, a MUD file must be explicit in describing the communication pattern of a device, and that includes indicating what is to be permitted or denied in either direction of communication.  This element takes a single value of either &#8220;to-device&#8221; or &#8220;from-device&#8221;, based on a typedef &#8220;direction&#8221;.</p>
<h1 id="rfc.section.3.8">
<a href="#rfc.section.3.8">3.8.</a> <a href="#manufacturer" id="manufacturer">manufacturer</a>
</h1>
<p id="rfc.section.3.8.p.1">This element consists of a hostname that would be matched against the authority component of another device&#8217;s MUD URL.</p>
<h1 id="rfc.section.3.9">
<a href="#rfc.section.3.9">3.9.</a> <a href="#same-manufacturer" id="same-manufacturer">same-manufacturer</a>
</h1>
<p id="rfc.section.3.9.p.1">This is an equivalent for when the manufacturer element is used to indicate the authority that is found in another device&#8217;s MUD URL matches that of the authority found in this device&#8217;s MUD URL.</p>
<h1 id="rfc.section.3.10">
<a href="#rfc.section.3.10">3.10.</a> <a href="#model" id="model">model</a>
</h1>
<p id="rfc.section.3.10.p.1">This string matches the one and only segment following the authority component of the MUD URL.  It refers to a model that is unique within the context of the authority.  It may also include product version information.  Thus how this field is constructed is entirely a local matter for the manufacturer.</p>
<h1 id="rfc.section.3.11">
<a href="#rfc.section.3.11">3.11.</a> <a href="#local-networks" id="local-networks">local-networks</a>
</h1>
<p id="rfc.section.3.11.p.1">This null-valued element expands to include local networks.  Its default expansion is that packets must not traverse toward a default route that is received from the router.  However, administrators may expand the expression as is appropriate in their deployments.</p>
<h1 id="rfc.section.3.12">
<a href="#rfc.section.3.12">3.12.</a> <a href="#controller" id="controller">controller</a>
</h1>
<p id="rfc.section.3.12.p.1">This URI specifies a value that a controller will register with the mud controller.  The element then is expanded to the set of hosts that are so registered.  This element may also be a URN.  In this case, the URN describes a well known service, such as DNS or NTP.</p>
<p id="rfc.section.3.12.p.2">Great care should be used when invoking the controller class.  For one thing, it requires some understanding by the administrator as to when it is appropriate.  Classes that are standardized may make it possible to code in certain intelligence.  Nonstandard classes may require substantially more care.  Pre-registration in such classes by controllers with the MUD server is encouraged.  The mechanism to do that is beyond the scope of this work.</p>
<h1 id="rfc.section.3.13">
<a href="#rfc.section.3.13">3.13.</a> <a href="#my-controller" id="my-controller">my-controller</a>
</h1>
<p id="rfc.section.3.13.p.1">This null-valued element establishes a class of controllers that are intended to control the device associated with the MUD file being referenced.</p>
<h1 id="rfc.section.3.14">
<a href="#rfc.section.3.14">3.14.</a> <a href="#direction-initiated" id="direction-initiated">direction-initiated</a>
</h1>
<p id="rfc.section.3.14.p.1">When applied this matches packets when the flow was initiated in the corresponding direction.  <a href="#RFC6092" class="xref">[RFC6092]</a> specifies IPv6 guidance best practices.  While that document is scoped specifically to IPv6, its contents are applicable for IPv4 as well.  When this flag is set, and the system has no reason to believe a flow has been initiated it MUST drop the packet.  This match SHOULD be applied with specific transport parameters, such as protocol.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#processing-of-the-mud-file" id="processing-of-the-mud-file">Processing of the MUD file</a>
</h1>
<p id="rfc.section.4.p.1">To keep things relatively simple in addition to whatever definitions exist, we also apply two additional default behaviors:</p>
<p></p>

<ul>
<li>Anything not explicitly permitted is denied.</li>
<li>Local DNS and NTP are, by default, permitted to and from the device.</li>
</ul>
<p id="rfc.section.4.p.3">An explicit description of the defaults can be found in <a href="#defaults" class="xref">Appendix B</a>.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#mudurl" id="mudurl">What does a MUD URL look like?</a>
</h1>
<p id="rfc.section.5.p.1">To begin with, MUD takes full advantage of both the https: scheme and the use of .well-known.  HTTPS is important in this case because a man in the middle attack could otherwise harm the operation of a class of devices.  .well-known is used because we wish to add additional structure to the URL.  And so the URL appears as follows:</p>
<pre>
   mud-url   = "https://" authority  "/.well-known/mud/" mud-rev
               "/" model ( "?" extras )
               ; authority is from RFC3986
   mud-rev   = "v1"
   model     = segment  ; from RFC3986
   extras    = query    ; from RFC3986
   
</pre>
<p id="rfc.section.5.p.2">mud-rev signifies the version of the manufacturer usage description file.  This memo specifies &#8220;v1&#8221; of that file.  Later versions may permit additional schemas or modify the format.  In order to provide for the broadest compatibility for the various transmission mechanisms, the length of the URL for v1 MUST NOT exceed 255 octets.</p>
<p id="rfc.section.5.p.3">&#8220;model&#8221; represents a device model as the manufacturer wishes to represent it.  It could be a brand name or something more specific.  It also may provide a means to indicate what version the product is.  Specifically if it has been updated in the field, this is the place where evidence of that update would appear.  The field should be changed when the intended communication patterns of a device change.  While from a controller standpoint, only comparison and matching operations are safe, it is envisioned that updates will require some administrative review.  Processing of this URL occurs as specified in <a href="#RFC2818" class="xref">[RFC2818]</a> and <a href="#RFC3986" class="xref">[RFC3986]</a>.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#the-mud-yang-model" id="the-mud-yang-model">The MUD YANG Model</a>
</h1>
<pre>
&lt;CODE BEGINS&gt;file "ietf-mud@2017-07-03.yang"
module ietf-mud {
 yang-version 1.1;
 namespace "urn:ietf:params:xml:ns:yang:ietf-mud";
 prefix "ietf-mud";

 import ietf-access-control-list {
   prefix "acl";
 }

 import ietf-yang-types {
   prefix "yang";
 }

 import ietf-inet-types {
   prefix "inet";
 }

 organization
   "IETF OPSAWG (Ops Area) Working Group";

 contact
      "WG Web: http://tools.ietf.org/wg/opsawg/
      WG List: opsawg@ietf.org
      Author: Eliot Lear
      lear@cisco.com
      Author: Ralph Droms
      rdroms@gmail.com
      Author: Dan Romascanu
      dromasca@gmail.com

   ";

 description
   "This YANG module defines a component that augments the
    IETF description of an access list.  This specific module
    focuses on additional filters that include local, model,
    and same-manufacturer.

   Copyright (c) 2016,2017 IETF Trust and the persons
   identified as the document authors.  All rights reserved.
   Redistribution and use in source and binary forms, with or
   without modification, is permitted pursuant to, and subject
   to the license terms contained in, the Simplified BSD
   License set forth in Section 4.c of the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info).
   This version of this YANG module is part of RFC XXXX; see
   the RFC itself for full legal notices.";

 revision "2017-07-03"  {
   description
     "More work on ACL usage.";
   reference "RFC XXXX: Manufacturer Usage Description
              Specification";
 }

 revision "2017-06-29"  {
   description
     "Take packet directionality out of ACL. " +
     "Introduce device container.";
   reference "RFC XXXX: Manufacturer Usage Description
              Specification";
 }

 revision "2017-04-18"  {
   description "Base version of MUD extensions to ACL model";
   reference "RFC XXXX: Manufacturer Usage Description
              Specification";
 }

 typedef direction {
    type enumeration {
        enum to-device {
          description "packets or flows destined to the target
                       device";
        }
        enum from-device {
          description "packets or flows destined from
                       the target device";
          }
        }
    description "Which way are we talking about?";
 }

 identity mud-acl {
   base "acl:acl-base";
   description
     "ACL that contains MUD-specific access control list entries.";
 }

 feature mud-acl {
   description
     "MUD ACL augmentations supported.";
 }

 container metainfo  {

   description "Information about when support end(ed), and
                when to refresh";

   leaf last-update {
     type yang:date-and-time;
     description "This is intended to be when
                  the MUD file was generated.";
   }

   leaf cache-validity {
     type uint8 {
       range "1..168";
     }
     description "The information retrieved from the MUD server is
                valid for these many hours, after which it should
                be refreshed.";
   }

   leaf masa-server {
     type inet:uri;
     description "The URI of the MASA server that network
     elements should forward requests to for this device.";
   }

   leaf is-supported {
     type boolean;
     description "The element is currently supported
                  by the manufacturer.";
   }
   leaf systeminfo {
     type inet:uri;
     description "A reference to a description of this device";
   }

   leaf-list extensions {
     type string;
     description "A list of extension names that are used in this MUD
                  file.  Each name is registered with the IANA and
                  described in an RFC.";
  }
 }

 grouping ACCESS_LISTS {
   description "A grouping for access lists in the context of device
                policy.";
   container access-lists {
     description "The access lists that should be applied to traffic
                    to or from the device.";
     list access-list {
       key "acl-name acl-type";
       description "Each entry on this list refers to an ACL that
                      should be present in the overall access list
                      data model. Each ACL is identified by name and
                      type.";
       leaf acl-name {
         type leafref {
           path "/acl:access-lists/acl:acl/acl:acl-name";
         }
         description "The name of the ACL for this entry.";
       }
       leaf acl-type {
         type identityref {
           base acl:acl-base;
         }
         description "The type of the ACL for this entry.";
       }
     }
   }
 }
 
 container device {
   description "A container allowing us to associate data with the
                device type being described in the instance document";

   container from-device-policy {
     description "The policies that should be enforced on traffic
                  coming from the device. These policies are not
                  necessarily intended to be enforced at a single
                  point, but may be rendered by the controller to any
                  relevant enorcement points in the network or
                  elsewhere.";
     uses ACCESS_LISTS;
   }
   
   container to-device-policy {
     description "The policies that should be enforced on traffic
                  going to the device. These policies are not
                  necessarily intended to be enforced at a single
                  point, but may be rendered by the controller to any
                  relevant enorcement points in the network or
                  elsewhere.";
     uses ACCESS_LISTS;
   }
   
 }
 
 augment "/acl:access-lists/acl:acl/" +
    "acl:access-list-entries/acl:ace/" +
    "acl:matches" {
   description "adding abstractions to avoid need of IP addresses";

   container mud-acl {
     if-feature mud-acl;
     must "../../../../acl-type = 'ietf-mud:mud-acl'";
     
     description
       "TODO; improve. MUD-specific matches.";
     
     leaf manufacturer {
       type inet:host;
       description "authority component of the manufacturer URI";
     }
     
     leaf same-manufacturer {
       type empty;
       description "expand to ACEs for each device
                  with the same origin";
     }
     
     leaf model {
       type string;
       description "specific model (including version) for a
                    given manufacturer";
     }
     
     leaf local-networks {
       type empty;
       description "this string is used to indicate networks
                  considered local in a given environment.";
     }
     
     leaf controller {
       type inet:uri;
       description "expands to one or more controllers for a
                  given service that is codified by inet:uri.";
     }
     
     leaf my-controller {
       type empty;
       description "This element indicates that the network should manage
                  a class of devices related to this MUD-URL that are
                  intended to control this device.";
     }
   }
 
 }
 
 augment "/acl:access-lists/acl:acl/" +
   "acl:access-list-entries/acl:ace/" +
   "acl:matches/acl:tcp-acl" {
   description "Adding domain names to matching";
   leaf direction-initiated {
     type direction;
     description "which direction a flow was initiated";
   }
 }
}
&lt;CODE ENDS&gt;
</pre>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#the-domain-name-extension-to-the-acl-model" id="the-domain-name-extension-to-the-acl-model">The Domain Name Extension to the ACL Model</a>
</h1>
<p id="rfc.section.7.p.1">This module specifies an extension to IETF-ACL model such that domain names may be referenced by augmenting the &#8220;matches&#8221; element.  Different implementations may deploy differing methods to maintain the mapping between IP address and domain name, if indeed any are needed.  However, the intent is that resources that are referred to using a name should be authorized (or not) within an access list.</p>
<p id="rfc.section.7.p.2">The structure of the change is as follows:</p>
<pre>
module: ietf-acldns
  augment /acl:access-lists/acl:acl/acl:access-list-entries \
          /acl:ace/acl:matches/acl:ipv4-acl:
    +--rw src-dnsname?   inet:host
    +--rw dst-dnsname?   inet:host
  augment /acl:access-lists/acl:acl/acl:access-list-entries \
          /acl:ace/acl:matches/acl:ipv6-acl:
    +--rw src-dnsname?   inet:host
    +--rw dst-dnsname?   inet:host
</pre>
<p id="rfc.section.7.p.3">The choice of these particular points in the access-list model is based on the assumption that we are in some way referring to IP-related resources, as that is what the DNS returns.  A domain name in our context is defined in <a href="#RFC6991" class="xref">[RFC6991]</a>. The augmentations are replicated across IPv4 and IPv6 to allow MUD file autjors the ability to control the IP version that the device may utilize.</p>
<p id="rfc.section.7.p.4">The following elements are defined.</p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#source-dnsname" id="source-dnsname">source-dnsname</a>
</h1>
<p id="rfc.section.7.1.p.1">The argument corresponds to a domain name of a source as specified by inet:host. Depending on how the model is used, it may or may not be resolved, as required by the implementation and circumstances.</p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#destination-dnsname" id="destination-dnsname">destination-dnsname</a>
</h1>
<p id="rfc.section.7.2.p.1">The argument corresponds to a domain name of a destination as specified by inet:host. Depending on how the model is used, it may or may not be resolved, as required by the implementation and circumstances.</p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> <a href="#the-ietf-acldns-model" id="the-ietf-acldns-model">The ietf-acldns Model</a>
</h1>
<pre>
&lt;CODE BEGINS&gt;file "ietf-acldns@2016-07-20.yang"
module ietf-acldns {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-acldns";
  prefix "ietf-acldns";

  import ietf-access-control-list {
    prefix "acl";
  }

  import ietf-inet-types {
    prefix "inet";
  }

  organization
    "IETF OPSAWG (Ops Area) Working Group";

  contact
       "WG Web: http://tools.ietf.org/wg/opsawg/
       WG List: opsawg@ietf.org
       Author: Eliot Lear
       lear@cisco.com
       Author: Ralph Droms
       rdroms@gmail.com
       Author: Dan Romascanu
       dromasca@gmail.com
    ";

  description
    "This YANG module defines a component that augments the
     IETF description of an access list to allow dns names
     as matching criteria.";

  revision "2017-07-03" {
    description "Clone across IP ACL types.";
    reference "RFC XXXX: Manufacturer Usage Description
               Specification";
  }

  revision "2016-07-20" {
    description "Base version of dnsname extension of ACL model";
    reference "RFC XXXX: Manufacturer Usage Description
               Specification";
  }

  grouping DNS_MATCHES {
    description "Domain names for matching.";

    leaf src-dnsname {
      type inet:host;
      description "domain name to be matched against";
    }
    leaf dst-dnsname {
      type inet:host;
      description "domain name to be matched against";
    }
  }
  
  augment "/acl:access-lists/acl:acl/" +
     "acl:access-list-entries/acl:ace/" +
     "acl:matches/acl:ipv4-acl" {
    description "Adding domain names to matching";
    uses DNS_MATCHES;
  }
  
  augment "/acl:access-lists/acl:acl/" +
     "acl:access-list-entries/acl:ace/" +
     "acl:matches/acl:ipv6-acl" {
    description "Adding domain names to matching";
    uses DNS_MATCHES;
  }
}
&lt;CODE ENDS&gt;
</pre>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#mud-file-example" id="mud-file-example">MUD File Example</a>
</h1>
<p id="rfc.section.8.p.1">This example contains two access lists that are intended to provide outbound access to a cloud service on TCP port 443.</p>
<p id="rfc.section.8.p.2">TODO: MAY NEED REVISED!</p>
<pre>
{
   "ietf-mud:metainfo": {
      "last-update": "2016-05-18T20:00:50Z",
      "cache-validity": 168
      },
   "ietf-access-control-list:access-lists":  {
     "acl": [ {
      "acl-name": "inbound-stuff",
      "acl-type" : "ipv4-acl",
      "ietf-mud:packet-direction" : "to-device",
      "access-list-entries": {
         "ace": [
            {
               "rule-name": "access-cloud",
               "matches": {
                 "ietf-acldns:src-dnsname":
                     "lighting-system.example.com",
                  "protocol" : 6,
                  "source-port-range" : {
                     "lower-port" : 443,
                     "upper-port" : 443
                     }
                  },
               "actions" : {
                 "permit" : [null]
                 }
              }
            ]
           }
         },
         {
      "acl-name": "outbound-stuff",
      "acl-type" : "ipv4-acl",
      "ietf-mud:packet-direction" : "from-device",
      "access-list-entries": {
         "ace": [
            {
               "rule-name": "access-cloud",
               "matches": {
                  "ietf-acldns:dst-dnsname":
                       "lighting-system.example.com",
                   "protocol" : 6,
                   "destination-port-range" : {
                     "lower-port" : 443,
                     "upper-port" : 443
                    }
                },
               "actions" : {
                   "permit" : [null]
                 }
              }
            ]
           }
         }
        ]
    }
}

</pre>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#dhcpopt" id="dhcpopt">The MUD URL DHCP Option</a>
</h1>
<p id="rfc.section.9.p.1">The IPv4 MUD URL client option has the following format:</p>
<pre>
  +------+-----+------------------------------
  | code | len |  MUD URL
  +------+-----+------------------------------

</pre>
<p id="rfc.section.9.p.2">Code OPTION_MUD_URL_V4 (161) is assigned by IANA.  len is a single octet that indicates the length of the URL in octets.  MUD URL is a URL.  MUD URLs MUST NOT exceed 255 octets.</p>
<p id="rfc.section.9.p.3">The IPv6 MUD URL client option has the following format:</p>
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |         OPTION_MUD_URL_V6     |        option-length          |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                            MUD URL                            |
  |                              ...                              |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.9.p.4">OPTION_MUD_URL_V6 (112; assigned by IANA).</p>
<p id="rfc.section.9.p.5">option-length contains the length of the URL in octets.</p>
<p id="rfc.section.9.p.6">The intent of this option is to provide both a new device classifier to the network as well as some recommended configuration to the routers that implement policy.  However, it is entirely the purview of the network system as managed by the network administrator to decide what to do with this information.  The key function of this option is simply to identify the type of device to the network in a structured way such that the policy can be easily found with existing toolsets.</p>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> <a href="#client-behavior" id="client-behavior">Client Behavior</a>
</h1>
<p id="rfc.section.9.1.p.1">A DHCPv4 client MAY emit a DHCPv4 option and a DHCPv6 client MAY emit DHCPv6 option.  These options are singletons, as specified in <a href="#RFC7227" class="xref">[RFC7227]</a>.  Because clients are intended to have at most one MUD URL associated with them, they may emit at most one MUD URL option via DHCPv4 and one MUD URL option via DHCPv6. In the case where both v4 and v6 DHCP options are emitted, the same URL MUST be used.</p>
<p id="rfc.section.9.1.p.2">Clients SHOULD log or otherwise report improper acknowledgments from servers, but they MUST NOT modify their MUD URL configuration based on a server&#8217;s response.  The server&#8217;s response is only an acknowledgment that the server has processed the option, and promises no specific network behavior to the client.  In particular, it may not be possible for the server to retrieve the file associated with the MUD URL, or the local network administration may not wish to use the usage description.  Neither of these situations should be considered in any way exceptional.</p>
<h1 id="rfc.section.9.2">
<a href="#rfc.section.9.2">9.2.</a> <a href="#server-behavior" id="server-behavior">Server Behavior</a>
</h1>
<p id="rfc.section.9.2.p.1">A DHCP server may ignore these options or take action based on receipt of these options.  If a server successfully parses the option and the URL, it MUST return the option with length field set to zero and a corresponding null URL field as an acknowledgment.  Even in this circumstance, no specific network behavior is guaranteed.  When a server consumes this option, it will either forward the URL and relevant client information to a network management system (such as the giaddr), or it will retrieve the usage description by resolving the URL.</p>
<p id="rfc.section.9.2.p.2">DHCP servers may implement MUD functionality themselves or they may pass along appropriate information to a network management system or MUD controller.  A DHCP server that does process the MUD URL MUST adhere to the process specified in <a href="#RFC2818" class="xref">[RFC2818]</a> and <a href="#RFC5280" class="xref">[RFC5280]</a> to validate the TLS certificate of the web server hosting the MUD file.  Those servers will retrieve the file, process it, create and install the necessary configuration on the relevant network element.  Servers SHOULD monitor the gateway for state changes on a given interface.  A DHCP server that does not provide MUD functionality and has forwarded a MUD URL to a MUD controller MUST notify the MUD controller of any corresponding change to the DHCP state of the client (such as expiration or explicit release of a network address lease).</p>
<h1 id="rfc.section.9.3">
<a href="#rfc.section.9.3">9.3.</a> <a href="#relay-requirements" id="relay-requirements">Relay Requirements</a>
</h1>
<p id="rfc.section.9.3.p.1">There are no additional requirements for relays.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#mudx509" id="mudx509">The Manufacturer Usage Description (MUD) URL X.509 Extension</a>
</h1>
<p id="rfc.section.10.p.1">This section defines an X.509 non-critical certificate extension that contains a single Uniform Resource Identifier (URI) that points to an on-line Manufacturer Usage Description concerning the certificate subject.  URI must be represented as described in Section 7.4 of <a href="#RFC5280" class="xref">[RFC5280]</a>.</p>
<p id="rfc.section.10.p.2">Any Internationalized Resource Identifiers (IRIs) MUST be mapped to URIs as specified in Section 3.1 of <a href="#RFC3987" class="xref">[RFC3987]</a> before they are placed in the certificate extension.</p>
<p id="rfc.section.10.p.3">The semantics of the URI are defined <a href="#mudurl" class="xref">Section 5</a> of this document.</p>
<p id="rfc.section.10.p.4">The choice of id-pe is based on guidance found in Section 4.2.2 of <a href="#RFC5280" class="xref">[RFC5280]</a>:</p>
<pre>
      These extensions may be used to direct applications to on-line
      information about the issuer or the subject.

</pre>
<p id="rfc.section.10.p.5">The MUD URL is precisely that: online information about the particular subject.</p>
<p id="rfc.section.10.p.6">The new extension is identified as follows:</p>
<pre>
&lt;CODE BEGINS&gt;

  MUDURLExtnModule-2016 { iso(1) identified-organization(3) dod(6)
               internet(1) security(5) mechanisms(5) pkix(7)
               id-mod(0) id-mod-mudURLExtn2016(88) }

  DEFINITIONS IMPLICIT TAGS ::= BEGIN

  -- EXPORTS ALL --

  IMPORTS
    EXTENSION
    FROM PKIX-CommonTypes-2009
            { iso(1) identified-organization(3) dod(6) internet(1)
              security(5) mechanisms(5) pkix(7) id-mod(0)
              id-mod-pkixCommon-02(57) }

    id-pe
    FROM PKIX1Explicit-2009
            { iso(1) identified-organization(3) dod(6) internet(1)
              security(5) mechanisms(5) pkix(7) id-mod(0)
              id-mod-pkix1-explicit-02(51) } ;
    MUDCertExtensions EXTENSION ::= { ext-MUDURL, ... }
    ext-MUDURL EXTENSION ::= { SYNTAX MUDURLSyntax
    IDENTIFIED BY id-pe-mud-url }

    id-pe-mud-url OBJECT IDENTIFIER ::= { id-pe 25 }

    MUDURLSyntax ::= IA5String

    END

&lt;CODE ENDS&gt;
</pre>
<p id="rfc.section.10.p.7">While this extension can appear in either an 802.AR manufacturer certificate (IDevID) or deployment certificate (LDevID), of course it is not guaranteed in either, nor is it guaranteed to be carried over.  It is RECOMMENDED that MUD controller implementations maintain a table that maps a device to its MUD-URL.</p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#lldp" id="lldp">The Manufacturer Usage Description LLDP extension</a>
</h1>
<p id="rfc.section.11.p.1">The IEEE802.1AB Link Layer Discovery Protocol (LLDP) is a one hop vendor-neutral&#160;link layer&#160;protocols used by end hosts network devices for advertising their identity, capabilities, and neighbors on an IEEE 802 local area network. Its Type-Length-Value (TLV) design allows for &#8216;vendor-specific&#8217; extensions to be defined. IANA has a registered IEEE 802 organizationally unique identifier (OUI) defined as documented in <a href="#RFC7042" class="xref">[RFC7042]</a>. The MUD LLDP extension uses a subtype defined in this document to carry the MUD URL.</p>
<p id="rfc.section.11.p.2">The LLDP vendor specific frame has the following format:</p>
<pre>
+--------+--------+----------+---------+--------------
|TLV Type|  len   |   OUI    |subtype  | MUD URL
|  =127  |        |= 00 00 5E|  = 1    |
|(7 bits)|(9 bits)|(3 octets)|(1 octet)|(1-255 octets)
+--------+--------+----------+---------+--------------

</pre>
<p id="rfc.section.11.p.3">where:</p>
<p></p>

<ul>
<li>TLV Type = 127 indicates a vendor-specific TLV</li>
<li>len &#8211; indicates the TLV string length</li>
<li>OUI = 00 00 5E is the organizationally unique identifier of IANA</li>
<li>subtype = 1 (to be assigned by IANA for the MUD URL)</li>
<li>MUD URL &#8211; the length MUST NOT exceed 255 octets</li>
</ul>
<p id="rfc.section.11.p.5">The intent of this extension is to provide both a new device classifier to the network as well as some recommended configuration to the routers that implement policy.  However, it is entirely the purview of the network system as managed by the network administrator to decide what to do with this information.  The key function of this extension is simply to identify the type of device to the network in a structured way such that the policy can be easily found with existing toolsets.</p>
<p id="rfc.section.11.p.6">Hosts, routers, or other network devices that implement this option are intended to have at most one MUD URL associated with them, so they may transmit at most one MUD URL value.</p>
<p id="rfc.section.11.p.7">Hosts, routers, or other network devices that implement this option may ignore these options or take action based on receipt of these options.  For example they may fill in information in the respective extensions of the LLDP Management Information Base (LLDP MIB). LLDP operates in a one-way direction. LLDPDUs are not exchanged as information requests by one device and response sent by another device. The other devices do not acknowledge LLDP information received from a device.&#160;No specific network behavior is guaranteed.  When a device consumes this extension, it may either forward the URL and relevant remote device information to a MUD controller, or it will retrieve the usage description by resolving the URL.</p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#creating-and-processing-of-signed-mud-files" id="creating-and-processing-of-signed-mud-files">Creating and Processing of Signed MUD Files</a>
</h1>
<p id="rfc.section.12.p.1">Because MUD files contain information that may be used to configure network access lists, they are sensitive.  To insure that they have not been tampered with, it is important that they be signed.  We make use of DER-encoded Cryptographic Message Syntax (CMS) <a href="#RFC5652" class="xref">[RFC5652]</a> for this purpose.</p>
<h1 id="rfc.section.12.1">
<a href="#rfc.section.12.1">12.1.</a> <a href="#creating-a-mud-file-signature" id="creating-a-mud-file-signature">Creating a MUD file signature</a>
</h1>
<p id="rfc.section.12.1.p.1">A MUD file MUST be signed using CMS as an opaque binary object.  In order to make successful verification more likely, intermediate certificates SHOULD be included.  The signature is stored at the same location as the MUD URL but with the suffix of &#8220;.p7s&#8221;.  Signatures are transferred using content-type &#8220;Application/pkcs7-signature&#8221;.</p>
<p id="rfc.section.12.1.p.2">For example:</p>
<pre>
% openssl cms -sign -signer mancertfile -inkey mankey \
              -in mudfile -binary -outform DER - \
              -certfile intermediatecert -out mudfile.p7s
</pre>
<p id="rfc.section.12.1.p.3">Note: A MUD file may need to be re-signed if the signature expires.</p>
<h1 id="rfc.section.12.2">
<a href="#rfc.section.12.2">12.2.</a> <a href="#verifying-a-mud-file-signature" id="verifying-a-mud-file-signature">Verifying a MUD file signature</a>
</h1>
<p id="rfc.section.12.2.p.1">Prior to retrieving a MUD file the MUD controller SHOULD retrieve the MUD signature file using the MUD URL with a suffix of &#8220;.p7s&#8221;.  For example, if the MUD URL is &#8220;https://example.com/.well-known/v1/modela&#8221;, the MUD signature URL will be &#8220;https://example.com/.well-known/v1/modela.p7s&#8221;.</p>
<p id="rfc.section.12.2.p.2">Upon retrieving a MUD file, a MUD controller MUST validate the signature of the file before continuing with further processing.  A MUD controller SHOULD produce an error and it MUST cease all processing of that file if the signature cannot be validated.  It is important that MUD controllers have some reason to trust the certificates they are seeing.  Therefore, it is RECOMMENDED that new signers be validated either directly by an administrator or by a service that has some reason to believe that the signer is a good actor.</p>
<p id="rfc.section.12.2.p.3">For Example:</p>
<pre>
% openssl cms -verify -in mudfile.p7s -inform DER -content mudfile
</pre>
<p id="rfc.section.12.2.p.4">Note the additional step of verifying the common trust root.</p>
<h1 id="rfc.section.13">
<a href="#rfc.section.13">13.</a> <a href="#ext" id="ext">Extensibility</a>
</h1>
<p id="rfc.section.13.p.1">One of our design goals is to see that MUD files are able to be understood by as broad a cross-section of systems as is possible.  Coupled with the fact that we have also chosen to leverage existing mechanisms, we are left with no ability to negotiate extensions and a limited desire for those extensions in any event.  A such, a two-tier extensibility framework is employed, as follows:</p>
<p></p>

<ol>
<li>At a coarse grain, a protocol version is included in a MUD URL.  This memo specifies MUD version 1.  Any and all changes are entertained when this version is bumped.  Transition approaches between versions would be a matter for discussion in future versions.</li>
<li>At a finer grain, only extensions that would not incur additional risk to the device are permitted.  Specifically, augmenting of the metainfo container is permitted with the understanding that such additions may be ignored.  In addition, augmentation of the ACL model is permitted so long as it remains safe for a given ACE to be ignored by the MUD Controller or the network elements it configures.  Most specifically, is is not permitted to include as an augmentation that modifies &#8220;deny&#8221; behavior without bumping the version.  Furthermore, implementations that are not able to parse a component of the ACE array MUST ignore the entire array entry (e.g., not the entire array) and MAY ignore the entire MUD file.</li>
</ol>
<h1 id="rfc.section.14">
<a href="#rfc.section.14">14.</a> <a href="#depcon" id="depcon">Deployment Considerations</a>
</h1>
<p id="rfc.section.14.p.1">Because MUD consists of a number of architectural building blocks, it is possible to assemble different deployment scenarios.  One key aspect is where to place policy enforcement.  In order to protect the device from other devices within a local deployment, policy can be enforced on the nearest switch or access point.  In order to limit unwanted traffic within a network, it may also be advisable to enforce policy as close to the Internet as possible.  In some circumstances, policy enforcement may not be available at the closest hop.  At that point, the risk of so-called east-west infection is increased to the number of devices that are able to communicate without protection.</p>
<p id="rfc.section.14.p.2">A caution about some of the classes: admission of a device into the &#8220;manufacturer&#8221; and &#8220;same-manufacturer&#8221; class may have impact on access of other devices.  Put another way, the admission may grow the access-list on switches connected to other devices, depending on how access is managed.  Therefore, care should be given on managing that access-list growth.  Alternative methods such as additional segmentation can be used to keep that growth within reason.</p>
<h1 id="rfc.section.15">
<a href="#rfc.section.15">15.</a> <a href="#secon" id="secon">Security Considerations</a>
</h1>
<p id="rfc.section.15.p.1">Based on how a MUD-URL is emitted, a device may be able to lie about what it is, thus gaining additional network access.  There are several means to limit risk in this case.  The most obvious is to only believe devices that make use of certificate-based authentication such as IEEE 802.1AR certificates.  When those certificates are not present, devices claiming to be of a certain manufacturer SHOULD NOT be included in that manufacturer grouping without additional validation of some form.  This will occur when it makes use of primitives such as &#8220;manufacturer&#8221; for the purpose of accessing devices of a particular type.  Similarly, network management systems may be able to fingerprint the device.  In such cases, the MUD-URL can act as a classifier that can be proven or disproven.  Fingerprinting may have other advantages as well: when 802.1AR certificates are used, because they themselves cannot change, fingerprinting offers the opportunity to add artificats to the MUD-URL.  The meaning of such artifacts is left as future work.</p>
<p id="rfc.section.15.p.2">Network management systems SHOULD NOT accept a usage description for a device with the same MAC address that has indicated a change of authority without some additional validation (such as review of the class).  New devices that present some form of unauthenticated MUD URL SHOULD be validated by some external means when they would be otherwise be given increased network access.</p>
<p id="rfc.section.15.p.3">It may be possible for a rogue manufacturer to inappropriately exercise the MUD file parser, in order to exploit a vulnerability.  There are three recommended approaches to address this threat.  The first is to validate the signature of the MUD file.  The second is to have a system do a primary scan of the file to ensure that it is both parseable and believable at some level.  MUD files will likely be relatively small, to start with.  The number of ACEs used by any given device should be relatively small as well.  It may also be useful to limit retrieval of MUD URLs to only those sites that are known to have decent web reputations.</p>
<p id="rfc.section.15.p.4">Use of a URL necessitates the use of domain names.  If a domain name changes ownership, the new owner of that domain may be able to provide MUD files that MUD controllers would consider valid.  There are a few approaches that can mitigate this attack.  First, MUD controllers SHOULD cache certificates used by the MUD file server.  When a new certificate is retrieved for whatever reason, the MUD controller should check to see if ownership of the domain has changed.  A fair programmatic approximation of this is when the name servers for the domain have changed.  If the actual MUD file has changed, the controller MAY check the WHOIS database to see if registration ownership of a domain has changed.  If a change has occured, or if for some reason it is not possible to determine whether ownership has changed, further review may be warranted.  Note, this remediation does not take into account the case of a device that was produced long ago and only recently fielded, or the case where a new MUD controller has been installed.</p>
<p id="rfc.section.15.p.5">The release of a MUD URL by a device reveals what the device is, and provides an attacker with guidance on what vulnerabilities may be present.</p>
<p id="rfc.section.15.p.6">While the MUD URL itself is not intended to be unique to a specific device, the release of the URL may aid an observer in identifying individuals when combined with other information.  This is a privacy consideration.</p>
<p id="rfc.section.15.p.7">In addressing both of these concerns, implementors should take into account what other information they are advertising through mechanisms such as mDNS<a href="#RFC6872" class="xref">[RFC6872]</a>, how a device might otherwise be identified, perhaps through how it behaves when it is connected to the network, whether a device is intended to be used by individuals or carry personal identifying information, and then apply appropriate data minimization techniques.  One approach is to make use of TEAP <a href="#RFC7170" class="xref">[RFC7170]</a> as the means to share information with authorized components in the network.  Network devices may also assist in limiting access to the MUD-URL through the use of mechanisms such as DHCPv6-Shield <a href="#RFC7610" class="xref">[RFC7610]</a>.</p>
<p id="rfc.section.15.p.8">Please note that the security considerations mentioned in Section 4.7 of <a href="#I-D.ietf-netmod-rfc6087bis" class="xref">[I-D.ietf-netmod-rfc6087bis]</a> are not applicable in this case because the YANG serialization is not intended to be accessed via NETCONF.  However, for those who try to instantiate this model in a device via NETCONF, all objects in each model in this draft exhibit similar security characteristics as <a href="#I-D.ietf-netmod-acl-model" class="xref">[I-D.ietf-netmod-acl-model]</a>.  The basic purpose of MUD is to configure access, and so by its very nature can be disruptive if used by unauthorized parties.</p>
<h1 id="rfc.section.16">
<a href="#rfc.section.16">16.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<h1 id="rfc.section.16.1">
<a href="#rfc.section.16.1">16.1.</a> <a href="#yang-module-registrations" id="yang-module-registrations">YANG Module Registrations</a>
</h1>
<p id="rfc.section.16.1.p.1">The following YANG modules are requested to be registred in the &#8220;IANA Module Names&#8221; registry:</p>
<p id="rfc.section.16.1.p.2">The ietf-mud module:</p>
<p></p>

<ul>
<li>Name: ietf-mud</li>
<li>XML Namespace: urn:ietf:params:xml:ns:yang:ietf-mud</li>
<li>Prefix: ief-mud</li>
<li>Reference: This memo</li>
</ul>
<p id="rfc.section.16.1.p.4">The ietf-acldns module:</p>
<p></p>

<ul>
<li>Name: ietf-acldns</li>
<li>XML Namespace: urn:ietf:params:xml:ns:yang:ietf-acldns</li>
<li>Prefix: ietf-acldns</li>
<li>Reference: This memo</li>
</ul>
<h1 id="rfc.section.16.2">
<a href="#rfc.section.16.2">16.2.</a> <a href="#dhcpv4-and-dhcpv6-options" id="dhcpv4-and-dhcpv6-options">DHCPv4 and DHCPv6 Options</a>
</h1>
<p id="rfc.section.16.2.p.1">The IANA has allocated option 161 in the Dynamic Host Configuration Protocol (DHCP) and Bootstrap Protocol (BOOTP) Parameters registry for the MUD DHCPv4 option.</p>
<p id="rfc.section.16.2.p.2">IANA is requested to allocated the DHCPv4 and v6 options as specified in <a href="#dhcpopt" class="xref">Section 9</a>.</p>
<h1 id="rfc.section.16.3">
<a href="#rfc.section.16.3">16.3.</a> <a href="#pkix-extensions" id="pkix-extensions">PKIX Extensions</a>
</h1>
<p id="rfc.section.16.3.p.1">IANA is kindly requested to make the   following assignments for:</p>
<p id="rfc.section.16.3.p.2">o The MUDURLExtnModule-2016 ASN.1 module in the &#8220;SMI Security for PKIX Module Identifier&#8221; registry (1.3.6.1.5.5.7.0).</p>
<p id="rfc.section.16.3.p.3">o id-pe-mud-url object identifier from the &#8220;SMI Security for PKIX Certificate Extension&#8221; registry (1.3.6.1.5.5.7.1).</p>
<p id="rfc.section.16.3.p.4">The use fo these values is specified in <a href="#mudx509" class="xref">Section 10</a>.</p>
<h1 id="rfc.section.16.4">
<a href="#rfc.section.16.4">16.4.</a> <a href="#well-known-uri-suffix" id="well-known-uri-suffix">Well Known URI Suffix</a>
</h1>
<p id="rfc.section.16.4.p.1">The IANA has allocated the URL suffix of &#8220;mud&#8221; as follows:</p>
<p id="rfc.section.16.4.p.2">o URI Suffix: &#8220;mud&#8221; o Specification documents: this document o Related information: n/a</p>
<h1 id="rfc.section.16.5">
<a href="#rfc.section.16.5">16.5.</a> <a href="#mime-media-type-registration-for-mud-files" id="mime-media-type-registration-for-mud-files">MIME Media-type Registration for MUD files</a>
</h1>
<p id="rfc.section.16.5.p.1">The following media-type is defined for transfer of MUD file:</p>
<pre>
 o Type name: application
 o Subtype name: mud+json
 o Required parameters: n/a
 o Optional parameters: n/a
 o Encoding considerations: 8bit; application/mud+json values
   are represented as a JSON object; UTF-8 encoding SHOULD be
   employed.
 o Security considerations: See {{secon}} of this document.
 o Interoperability considerations: n/a
 o Published specification: this document
 o Applications that use this media type: MUD controllers as
   specified by this document.
 o Fragment identifier considerations: n/a
 o Additional information:

     Magic number(s): n/a
     File extension(s): n/a
     Macintosh file type code(s): n/a

 o Person &amp; email address to contact for further information:
   Eliot Lear &lt;lear@cisco.com&gt;, Ralph Droms &lt;rdroms@cisco.com&gt;
 o Intended usage: COMMON
 o Restrictions on usage: none
 o Author: 
      Eliot Lear &lt;lear@cisco.com&gt;
      Ralph Droms &lt;rdroms@cisco.com&gt;
 o Change controller: IESG
 o Provisional registration? (standards tree only): No.

</pre>
<h1 id="rfc.section.16.6">
<a href="#rfc.section.16.6">16.6.</a> <a href="#lldp-iana-tlv-subtype-registry" id="lldp-iana-tlv-subtype-registry">LLDP IANA TLV Subtype Registry</a>
</h1>
<p id="rfc.section.16.6.p.1">IANA is requested to create a new registry for IANA Link Layer Discovery Protocol (LLDP) TLV subtype values. The recommended policy for this registry is Expert Review. The maximum number of entries in the registry is 256.</p>
<p id="rfc.section.16.6.p.2">IANA is required to populate the initial registry with the value:</p>
<p id="rfc.section.16.6.p.3">LLDP subtype value = 1 (All the other 255 values should be initially marked as &#8216;Unassigned&#8217;.)</p>
<p id="rfc.section.16.6.p.4">Description = the Manufacturer Usage Description (MUD) Uniform Resource Locator (URL)</p>
<p id="rfc.section.16.6.p.5">Reference = &lt; this document &gt;</p>
<h1 id="rfc.section.16.7">
<a href="#rfc.section.16.7">16.7.</a> <a href="#the-mud-well-known-universal-resource-name-urns" id="the-mud-well-known-universal-resource-name-urns">The MUD Well Known Universal Resource Name (URNs)</a>
</h1>
<p id="rfc.section.16.7.p.1">The following parameter registry is requested to be added in accordance with <a href="#RFC3553" class="xref">[RFC3553]</a></p>
<pre>
   Registry name: "urn:ietf:params:mud" is requested.
   Specification: this document
   Repository: this document
   Index value:  Encoded identically to a TCP/UDP port service
                 name, as specified in Section 5.1 of [RFC6335]
</pre>
<p id="rfc.section.16.7.p.2">The following entries should be added to the &#8220;urn:ietf:params:mud&#8221; name space:</p>
<p id="rfc.section.16.7.p.3">&#8220;urn:ietf:params:mud:dns&#8221; refers to the service specified by <a href="#RFC1123" class="xref">[RFC1123]</a>.  &#8220;urn:ietf:params:mud:ntp&#8221; refers to the service specified by <a href="#RFC5905" class="xref">[RFC5905]</a>.</p>
<h1 id="rfc.section.17">
<a href="#rfc.section.17">17.</a> <a href="#acknowledgments" id="acknowledgments">Acknowledgments</a>
</h1>
<p id="rfc.section.17.p.1">The authors would like to thank Einar Nilsen-Nygaard, Bernie Volz, Tom Gindin, Brian Weis, Sandeep Kumar, Thorsten Dahm, John Bashinski, Steve Rich, Jim Bieda, and Dan Wing for their valuable advice and reviews.  Russ Housley entirely rewrote <a href="#mudx509" class="xref">Section 10</a> to be a complete module.  Adrian Farrel provided the basis for privacy considerations text.  Kent Watson provided a thorough review of the archictecture and the YANG model.  The remaining errors in this work are entirely the responsibility of the author.</p>
<h1 id="rfc.references">
<a href="#rfc.references">18.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">18.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-anima-bootstrapping-keyinfra">[I-D.ietf-anima-bootstrapping-keyinfra]</b></td>
<td class="top">
<a>Pritikin, M.</a>, <a>Richardson, M.</a>, <a>Behringer, M.</a>, <a>Bjarnason, S.</a> and <a>K. Watsen</a>, "<a href="http://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-06">Bootstrapping Remote Secure Key Infrastructures (BRSKI)</a>", Internet-Draft draft-ietf-anima-bootstrapping-keyinfra-06, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-netmod-acl-model">[I-D.ietf-netmod-acl-model]</b></td>
<td class="top">
<a>Bogdanovic, D.</a>, <a>Jethanandani, M.</a>, <a>Huang, L.</a>, <a>Agarwal, S.</a> and <a>D. Blair</a>, "<a href="http://tools.ietf.org/html/draft-ietf-netmod-acl-model-11">Network Access Control List (ACL) YANG Data Model</a>", Internet-Draft draft-ietf-netmod-acl-model-11, June 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-netmod-rfc6087bis">[I-D.ietf-netmod-rfc6087bis]</b></td>
<td class="top">
<a>Bierman, A.</a>, "<a href="http://tools.ietf.org/html/draft-ietf-netmod-rfc6087bis-13">Guidelines for Authors and Reviewers of YANG Data Model Documents</a>", Internet-Draft draft-ietf-netmod-rfc6087bis-13, June 2017.</td>
</tr>
<tr>
<td class="reference"><b id="IEEE8021AB">[IEEE8021AB]</b></td>
<td class="top">
<a>Institute for Electrical and Electronics Engineers</a>, "<a>IEEE Standard for Local and  Metropolitan Area Networks-- Station and Media Access Control Connectivity Discovery</a>", n.d..</td>
</tr>
<tr>
<td class="reference"><b id="RFC1123">[RFC1123]</b></td>
<td class="top">
<a>Braden, R.</a>, "<a href="http://tools.ietf.org/html/rfc1123">Requirements for Internet Hosts - Application and Support</a>", STD 3, RFC 1123, DOI 10.17487/RFC1123, October 1989.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2131">[RFC2131]</b></td>
<td class="top">
<a>Droms, R.</a>, "<a href="http://tools.ietf.org/html/rfc2131">Dynamic Host Configuration Protocol</a>", RFC 2131, DOI 10.17487/RFC2131, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2818">[RFC2818]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>", RFC 2818, DOI 10.17487/RFC2818, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3315">[RFC3315]</b></td>
<td class="top">
<a>Droms, R.</a>, <a>Bound, J.</a>, <a>Volz, B.</a>, <a>Lemon, T.</a>, <a>Perkins, C.</a> and <a>M. Carney</a>, "<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>", RFC 3315, DOI 10.17487/RFC3315, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3748">[RFC3748]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Blunk, L.</a>, <a>Vollbrecht, J.</a>, <a>Carlson, J.</a> and <a>H. Levkowetz</a>, "<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>", RFC 3748, DOI 10.17487/RFC3748, June 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a>Berners-Lee, T.</a>, <a>Fielding, R.</a> and <a>L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, DOI 10.17487/RFC3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3987">[RFC3987]</b></td>
<td class="top">
<a>Duerst, M.</a> and <a>M. Suignard</a>, "<a href="http://tools.ietf.org/html/rfc3987">Internationalized Resource Identifiers (IRIs)</a>", RFC 3987, DOI 10.17487/RFC3987, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, DOI 10.17487/RFC5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5652">[RFC5652]</b></td>
<td class="top">
<a>Housley, R.</a>, "<a href="http://tools.ietf.org/html/rfc5652">Cryptographic Message Syntax (CMS)</a>", STD 70, RFC 5652, DOI 10.17487/RFC5652, September 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5905">[RFC5905]</b></td>
<td class="top">
<a>Mills, D.</a>, <a>Martin, J.</a>, <a>Burbank, J.</a> and <a>W. Kasch</a>, "<a href="http://tools.ietf.org/html/rfc5905">Network Time Protocol Version 4: Protocol and Algorithms Specification</a>", RFC 5905, DOI 10.17487/RFC5905, June 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6020">[RFC6020]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="http://tools.ietf.org/html/rfc6020">YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)</a>", RFC 6020, DOI 10.17487/RFC6020, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6092">[RFC6092]</b></td>
<td class="top">
<a>Woodyatt, J.</a>, "<a href="http://tools.ietf.org/html/rfc6092">Recommended Simple Security Capabilities in Customer Premises Equipment (CPE) for Providing Residential IPv6 Internet Service</a>", RFC 6092, DOI 10.17487/RFC6092, January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6335">[RFC6335]</b></td>
<td class="top">
<a>Cotton, M.</a>, <a>Eggert, L.</a>, <a>Touch, J.</a>, <a>Westerlund, M.</a> and <a>S. Cheshire</a>, "<a href="http://tools.ietf.org/html/rfc6335">Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry</a>", BCP 165, RFC 6335, DOI 10.17487/RFC6335, August 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6991">[RFC6991]</b></td>
<td class="top">
<a>Schoenwaelder, J.</a>, "<a href="http://tools.ietf.org/html/rfc6991">Common YANG Data Types</a>", RFC 6991, DOI 10.17487/RFC6991, July 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7227">[RFC7227]</b></td>
<td class="top">
<a>Hankins, D.</a>, <a>Mrugalski, T.</a>, <a>Siodelski, M.</a>, <a>Jiang, S.</a> and <a>S. Krishnan</a>, "<a href="http://tools.ietf.org/html/rfc7227">Guidelines for Creating New DHCPv6 Options</a>", BCP 187, RFC 7227, DOI 10.17487/RFC7227, May 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7610">[RFC7610]</b></td>
<td class="top">
<a>Gont, F.</a>, <a>Liu, W.</a> and <a>G. Van de Velde</a>, "<a href="http://tools.ietf.org/html/rfc7610">DHCPv6-Shield: Protecting against Rogue DHCPv6 Servers</a>", BCP 199, RFC 7610, DOI 10.17487/RFC7610, August 2015.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">18.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="FW95">[FW95]</b></td>
<td class="top">
<a>Chapman, D.</a> and <a>E. Zwicky</a>, "<a>Building Internet Firewalls</a>", January 1995.</td>
</tr>
<tr>
<td class="reference"><b id="IEEE8021AR">[IEEE8021AR]</b></td>
<td class="top">
<a>Institute for Electrical and Electronics Engineers</a>, "<a>Secure Device Identity</a>", 1998.</td>
</tr>
<tr>
<td class="reference"><b id="ISO.8601.1988">[ISO.8601.1988]</b></td>
<td class="top">
<a>International Organization for Standardization</a>, "<a>Data elements and interchange formats - Information interchange - Representation of dates and times</a>", ISO Standard 8601, June 1988.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1984">[RFC1984]</b></td>
<td class="top">
<a>IAB</a> and <a>IESG</a>, "<a href="http://tools.ietf.org/html/rfc1984">IAB and IESG Statement on Cryptographic Technology and the Internet</a>", BCP 200, RFC 1984, DOI 10.17487/RFC1984, August 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3339">[RFC3339]</b></td>
<td class="top">
<a>Klyne, G.</a> and <a>C. Newman</a>, "<a href="http://tools.ietf.org/html/rfc3339">Date and Time on the Internet: Timestamps</a>", RFC 3339, DOI 10.17487/RFC3339, July 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3553">[RFC3553]</b></td>
<td class="top">
<a>Mealling, M.</a>, <a>Masinter, L.</a>, <a>Hardie, T.</a> and <a>G. Klyne</a>, "<a href="http://tools.ietf.org/html/rfc3553">An IETF URN Sub-namespace for Registered Protocol Parameters</a>", BCP 73, RFC 3553, DOI 10.17487/RFC3553, June 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6872">[RFC6872]</b></td>
<td class="top">
<a>Gurbani, V.</a>, <a>Burger, E.</a>, <a>Anjali, T.</a>, <a>Abdelnur, H.</a> and <a>O. Festor</a>, "<a href="http://tools.ietf.org/html/rfc6872">The Common Log Format (CLF) for the Session Initiation Protocol (SIP): Framework and Information Model</a>", RFC 6872, DOI 10.17487/RFC6872, February 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7042">[RFC7042]</b></td>
<td class="top">
<a>Eastlake 3rd, D.</a> and <a>J. Abley</a>, "<a href="http://tools.ietf.org/html/rfc7042">IANA Considerations and IETF Protocol and Documentation Usage for IEEE 802 Parameters</a>", BCP 141, RFC 7042, DOI 10.17487/RFC7042, October 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7170">[RFC7170]</b></td>
<td class="top">
<a>Zhou, H.</a>, <a>Cam-Winget, N.</a>, <a>Salowey, J.</a> and <a>S. Hanna</a>, "<a href="http://tools.ietf.org/html/rfc7170">Tunnel Extensible Authentication Protocol (TEAP) Version 1</a>", RFC 7170, DOI 10.17487/RFC7170, May 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7452">[RFC7452]</b></td>
<td class="top">
<a>Tschofenig, H.</a>, <a>Arkko, J.</a>, <a>Thaler, D.</a> and <a>D. McPherson</a>, "<a href="http://tools.ietf.org/html/rfc7452">Architectural Considerations in Smart Object Networking</a>", RFC 7452, DOI 10.17487/RFC7452, March 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7488">[RFC7488]</b></td>
<td class="top">
<a>Boucadair, M.</a>, <a>Penno, R.</a>, <a>Wing, D.</a>, <a>Patil, P.</a> and <a>T. Reddy</a>, "<a href="http://tools.ietf.org/html/rfc7488">Port Control Protocol (PCP) Server Selection</a>", RFC 7488, DOI 10.17487/RFC7488, March 2015.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#changes-from-earlier-versions" id="changes-from-earlier-versions">Changes from Earlier Versions</a>
</h1>
<p id="rfc.section.A.p.1">RFC Editor to remove this section prior to publication.</p>
<p id="rfc.section.A.p.2">Draft -05 to -06:</p>
<p></p>

<ul>
<li>Make clear that this is a component architecture (Polk and Watson)</li>
<li>Add order of operations (Watson)</li>
<li>Add extensions leaf-list (Pritikin)</li>
<li>Remove previous-mud-file (Watson)</li>
<li>Modify text in last-update (Watson)</li>
<li>Clarify local networks (Weis, Watson)</li>
<li>Fix contact info (Watson)</li>
<li>Terminology clarification (Weis)</li>
<li>Advice on how to handle LDevIDs (Watson)</li>
<li>Add deployment considerations (Watson)</li>
<li>Add some additional text about fingerprinting (Watson)</li>
<li>Appropriate references to 6087bis (Watson)</li>
<li>Change systeminfo to a URL to be referenced (Lear)</li>
</ul>
<p id="rfc.section.A.p.4">Draft -04 to -05: * syntax error correction</p>
<p id="rfc.section.A.p.5">Draft -03 to -04: * Re-add my-controller</p>
<p id="rfc.section.A.p.6">Draft -02 to -03: * Additional IANA updates * Format correction in YANG.  * Add reference to TEAP.</p>
<p id="rfc.section.A.p.7">Draft -01 to -02: * Update IANA considerations * Accept Russ Housley rewrite of X.509 text * Include privacy considerations text * Redo the URL limit.  Still 255 bytes, but now stated in the URL definition.  * Change URI registration to be under urn:ietf:params</p>
<p id="rfc.section.A.p.8">Draft -00 to -01: * Fix cert trust text.  * change supportInformation to meta-info * Add an informaitonal element in.  * add urn registry and create first entry * add default elements</p>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#defaults" id="defaults">Default MUD elements</a>
</h1>
<p id="rfc.section.B.p.1">What follows is a MUD file that permits DNS traffic to a controller that is registered with the URN &#8220;urn:ietf:params:mud:dns&#8221; and traffic NTP to a controller that is registered &#8220;urn:ietf:params:mud:ntp&#8221;.  This is considered the default behavior and the ACEs are in effect appended to whatever other ACEs.  To block DNS or NTP one repeats the matching statement but replace &#8220;permit&#8221; with deny. Because ACEs are processed in the order they are received, the defaults would not be reached.  A MUD controller might further decide to optimize to simply not include the defaults when they are overriden.</p>
<p id="rfc.section.B.p.2">A complete MUD entry is included below.</p>
<pre>
{
  "ietf-mud:metainfo": {
    "last-update": "2016-09-27T15:10:24+02:00",
    "cache-validity": 168
  },
  "acl:access-lists": {
    "access-list": [
      {
        "acl-name": "mud-53134-v4in",
        "acl-type": "ipv4-acl",
        "ietf-mud:packet-direction": "to-device",
        "access-list-entries": {
          "ace": [
            {
              "rule-name": "entout0-in",
              "matches": {
                "ietf-mud:controller": "urn:ietf:params:mud:dns",
                "protocol": 17,
                "source-port-range": {
                  "lower-port": 53,
                  "upper-port": 53
                }
              },
              "actions": {
                "permit": [
                  null
                ]
              }
            },
            {
              "rule-name": "entout1-in",
              "matches": {
                "ietf-mud:controller": "urn:ietf:params:mud:dns",
                "protocol": 6,
                "source-port-range": {
                  "lower-port": 53,
                  "upper-port": 53
                }
              },
              "actions": {
                "permit": [
                  null
                ]
              }
            },
            {
              "rule-name": "entout2-in",
              "matches": {
                "ietf-mud:controller": "urn:ietf:params:mud:ntp",
                "protocol": 17,
                "source-port-range": {
                  "lower-port": 123,
                  "upper-port": 123
                }
              },
              "actions": {
                "permit": [
                  null
                ]
              }
            }
          ]
        }
      },
      {
        "acl-name": "mud-53134-v4out",
        "acl-type": "ipv4-acl",
        "ietf-mud:packet-direction": "from-device",
        "access-list-entries": {
          "ace": [
            {
              "rule-name": "entout0-in",
              "matches": {
                "ietf-mud:controller": "urn:ietf:params:mud:dns",
                "protocol": 17,
                "source-port-range": {
                  "lower-port": 53,
                  "upper-port": 53
                }
              },
              "actions": {
                "permit": [
                  null
                ]
              }
            },
            {
              "rule-name": "entout1-in",
              "matches": {
                "ietf-mud:controller": "urn:ietf:params:mud:dns",
                "protocol": 6,
                "source-port-range": {
                  "lower-port": 53,
                  "upper-port": 53
                }
              },
              "actions": {
                "permit": [
                  null
                ]
              }
            },
            {
              "rule-name": "entout2-in",
              "matches": {
                "ietf-mud:controller": "urn:ietf:params:mud:ntp",
                "protocol": 17,
                "source-port-range": {
                  "lower-port": 123,
                  "upper-port": 123
                }
              },
              "actions": {
                "permit": [
                  null
                ]
              }
            }
          ]
        }
      },
      {
        "acl-name": "mud-53134-v6in",
        "acl-type": "ipv6-acl",
        "ietf-mud:packet-direction": "to-device",
        "access-list-entries": {
          "ace": [
            {
              "rule-name": "entout0-in",
              "matches": {
                "ietf-mud:controller": "urn:ietf:params:mud:dns",
                "protocol": 17,
                "source-port-range": {
                  "lower-port": 53,
                  "upper-port": 53
                }
              },
              "actions": {
                "permit": [
                  null
                ]
              }
            },
            {
              "rule-name": "entout1-in",
              "matches": {
                "ietf-mud:controller": "urn:params:mud:dns",
                "protocol": 6,
                "source-port-range": {
                  "lower-port": 53,
                  "upper-port": 53
                }
              },
              "actions": {
                "permit": [
                  null
                ]
              }
            },
            {
              "rule-name": "entout2-in",
              "matches": {
                "ietf-mud:controller": "urn:ietf:params:mud:ntp",
                "protocol": 17,
                "source-port-range": {
                  "lower-port": 123,
                  "upper-port": 123
                }
              },
              "actions": {
                "permit": [
                  null
                ]
              }
            }
          ]
        }
      },
      {
        "acl-name": "mud-53134-v6out",
        "acl-type": "ipv6-acl",
        "ietf-mud:packet-direction": "from-device",
        "access-list-entries": {
          "ace": [
            {
              "rule-name": "entout0-in",
              "matches": {
                "ietf-mud:controller": "urn:ietf:params:mud:dns",
                "protocol": 17,
                "source-port-range": {
                  "lower-port": 53,
                  "upper-port": 53
                }
              },
              "actions": {
                "permit": [
                  null
                ]
              }
            },
            {
              "rule-name": "entout1-in",
              "matches": {
                "ietf-mud:controller": "urn:ietf:params:mud:dns",
                "protocol": 6,
                "source-port-range": {
                  "lower-port": 53,
                  "upper-port": 53
                }
              },
              "actions": {
                "permit": [
                  null
                ]
              }
            },
            {
              "rule-name": "entout2-in",
              "matches": {
                "ietf-mud:controller": "urn:ietf:params:mud:ntp",
                "protocol": 17,
                "source-port-range": {
                  "lower-port": 123,
                  "upper-port": 123
                }
              },
              "actions": {
                "permit": [
                  null
                ]
              }
            }
          ]
        }
      }
    ]
  }
}
</pre>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Eliot Lear</span> 
	  <span class="n hidden">
		<span class="family-name">Lear</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span class="vcardline">Richtistrasse 7</span>

	  <span class="vcardline">
		<span class="locality">Wallisellen</span>,  
		<span class="region"></span>
		<span class="code">CH-8304</span>
	  </span>
	  <span class="country-name vcardline">Switzerland</span>
	</span>
	<span class="vcardline">Phone: +41 44 878 9200</span>

<span class="vcardline">EMail: <a href="mailto:lear@cisco.com">lear@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ralph Droms</span> 
	  <span class="n hidden">
		<span class="family-name">Droms</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">Phone: +1 978 376 3731</span>

<span class="vcardline">EMail: <a href="mailto:rdroms@gmail.com">rdroms@gmail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dan Romascanu</span> 
	  <span class="n hidden">
		<span class="family-name">Romascanu</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">Phone: +972 54 5555347</span>

<span class="vcardline">EMail: <a href="mailto:dromasca@gmail.com">dromasca@gmail.com</a></span>

  </address>
</div>

</body>
</html>
